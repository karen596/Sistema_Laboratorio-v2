{% extends 'base.html' %}
{% set title = 'Configuración del Sistema' %}
{% block content %}
<style>
  .table thead th {
    background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
    color: #2d6a4f;
    font-weight: 600;
    border: none;
    padding: 12px;
  }
  .table tbody tr {
    transition: all 0.3s ease;
  }
  .table tbody tr:hover {
    background: rgba(0, 184, 148, 0.05);
    transform: scale(1.01);
  }
</style>

<!-- Breadcrumb -->
<nav aria-label="breadcrumb" class="mb-3">
  <ol class="breadcrumb">
    <li class="breadcrumb-item"><a href="{{ url_for('dashboard') }}"><i class="bi bi-house-door"></i> Dashboard</a></li>
    <li class="breadcrumb-item active" aria-current="page">Configuración</li>
  </ol>
</nav>

<!-- Header -->
<div class="card border-0 shadow-sm mb-4" style="background: linear-gradient(135deg, #2d6a4f 0%, #40916c 100%);">
  <div class="card-body p-4">
    <div class="d-flex justify-content-between align-items-center flex-wrap gap-3">
      <div>
        <h4 class="mb-1 text-white fw-bold"><i class="bi bi-gear-fill me-2"></i>Configuración del Sistema</h4>
        <p class="mb-0 text-white opacity-90">Parámetros y ajustes del sistema</p>
      </div>
      <div>
        <span class="badge rounded-pill px-3 py-2" style="background: linear-gradient(135deg, #059669 0%, #047857 100%);">
          <i class="bi bi-check-circle me-1"></i>Sistema Activo
        </span>
      </div>
    </div>
  </div>
</div>

{% if configuraciones and configuraciones|length > 0 %}
<!-- Buscador -->
<div class="card border-0 shadow-sm mb-4">
  <div class="card-header border-0" style="background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);">
    <h6 class="mb-0 fw-bold" style="color: #2d6a4f;"><i class="bi bi-funnel me-2"></i>Buscar Configuración</h6>
  </div>
  <div class="card-body">
    <div class="input-group">
      <span class="input-group-text" style="background: #f8f9fa;"><i class="bi bi-search"></i></span>
      <input type="text" id="filtroConfig" class="form-control" placeholder="Buscar por parámetro o descripción...">
    </div>
  </div>
</div>

<!-- Tabla de Configuraciones -->
<div class="card border-0 shadow-sm">
  <div class="card-header border-0" style="background: linear-gradient(135deg, #2d6a4f 0%, #40916c 100%);">
    <h6 class="mb-0 text-white fw-bold"><i class="bi bi-list-ul me-2"></i>Parámetros del Sistema ({{ configuraciones|length }})</h6>
  </div>
  <div class="card-body p-0">
    <div class="table-responsive">
      <table class="table table-hover align-middle mb-0" id="tablaConfig">
        <thead class="table-light">
          <tr>
            <th style="width: 30%;">Parámetro</th>
            <th style="width: 25%;">Valor</th>
            <th style="width: 45%;">Descripción</th>
          </tr>
        </thead>
        <tbody>
          {% for c in configuraciones %}
          <tr data-clave="{{ c.clave|lower }}" data-desc="{{ c.descripcion|lower }}">
            <td>
              <strong style="color: #2d6a4f;">{{ c.clave }}</strong>
            </td>
            <td>
              <code class="px-2 py-1 rounded" style="background: linear-gradient(135deg, rgba(0, 184, 148, 0.1) 0%, rgba(0, 155, 125, 0.1) 100%); color: #00b894; border: 1px solid rgba(0, 184, 148, 0.2);">{{ c.valor }}</code>
            </td>
            <td class="text-muted">
              <small>{{ c.descripcion }}</small>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
  <div class="card-footer border-0" style="background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);">
    <small>
      <i class="bi bi-info-circle me-1" style="color: #00b894;"></i>
      <strong style="color: #2d6a4f;">Nota:</strong> Para modificar estos valores, contacte al administrador del sistema
    </small>
  </div>
</div>

<script>
// Filtro de búsqueda
const filtro = document.getElementById('filtroConfig');
const tbody = document.querySelector('#tablaConfig tbody');

filtro.addEventListener('input', () => {
  const termino = filtro.value.toLowerCase();
  
  [...tbody.rows].forEach(row => {
    const clave = row.dataset.clave || '';
    const desc = row.dataset.desc || '';
    const coincide = clave.includes(termino) || desc.includes(termino);
    row.classList.toggle('d-none', !coincide);
  });
});
</script>

{% else %}
<div class="card shadow-sm">
  <div class="card-body text-center py-5">
    <i class="bi bi-exclamation-triangle fs-1 text-warning"></i>
    <h4 class="mt-3">No hay configuraciones disponibles</h4>
    <p class="text-muted">La tabla de configuración está vacía o no existe.</p>
    <p class="text-muted">Ejecute el script <code>crear_tabla_configuracion.py</code> para inicializar las configuraciones.</p>
  </div>
</div>
{% endif %}

{% endblock %}
